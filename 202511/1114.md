## 1114 Spring Boot μ‹¬ν™”: μμ™Έ μ²λ¦¬, κ²€μ¦, λΉ„λ™κΈ° μ²λ¦¬

---

### β… 1. Springμ μμ™Έ μ²λ¦¬ (Exception Handling)

*   μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ μ¤‘ λ°μƒν•λ” μμ™Έλ¥Ό μ²λ¦¬ν•μ—¬, μ‚¬μ©μμ—κ²λ” μΉμ ν• μ—λ¬ λ©”μ‹μ§€λ¥Ό λ³΄μ—¬μ£Όκ³ , μ‹μ¤ν…μ€ λΉ„μ •μƒμ μΌλ΅ μΆ…λ£λμ§€ μ•λ„λ΅ κ΄€λ¦¬ν•λ” κ²ƒμ€ λ§¤μ° μ¤‘μ”ν•©λ‹λ‹¤. Springμ€ μμ™Έλ¥Ό ν¨μ¨μ μΌλ΅ μ²λ¦¬ν•κΈ° μ„ν• μ—¬λ¬ λ°©λ²•μ„ μ κ³µν•©λ‹λ‹¤.

#### β• `@ExceptionHandler`

*   **κ°λ…**: νΉμ • **μ»¨νΈλ΅¤λ¬ λ‚΄μ—μ„** λ°μƒν• μμ™Έλ¥Ό μ΅μ•„ μ²λ¦¬ν•λ” λ©”μ„λ“λ¥Ό μ§€μ •ν•λ” μ–΄λ…Έν…μ΄μ…μ…λ‹λ‹¤.
*   **λ‹¨μ **: ν•΄λ‹Ή μ»¨νΈλ΅¤λ¬ λ‚΄μ—μ„λ§ μ ν¨ν•λ―€λ΅, μ—¬λ¬ μ»¨νΈλ΅¤λ¬μ—μ„ λ°μƒν•λ” κ³µν†µ μμ™Έλ¥Ό μ²λ¦¬ν•λ ¤λ©΄ μ½”λ“ μ¤‘λ³µμ΄ λ°μƒν•©λ‹λ‹¤.

#### β• `@RestControllerAdvice` (λλ” `@ControllerAdvice`)

*   **κ°λ…**: **μ• ν”λ¦¬μΌ€μ΄μ… μ „μ—­(Global)**μ— κ±Έμ³ λ°μƒν•λ” μμ™Έλ¥Ό ν• κ³³μ—μ„ μ¤‘μ•™ μ§‘μ¤‘μ μΌλ΅ μ²λ¦¬ν•  μ μκ² ν•΄μ£Όλ” κ°•λ ¥ν• κΈ°λ¥μ…λ‹λ‹¤.
*   **λ™μ‘ λ°©μ‹**: `@RestControllerAdvice` μ–΄λ…Έν…μ΄μ…μ΄ λ¶™μ€ ν΄λμ¤ λ‚΄μ— `@ExceptionHandler` λ©”μ„λ“λ¥Ό μ‘μ„±ν•λ©΄, μ–΄λ–¤ μ»¨νΈλ΅¤λ¬μ—μ„ μμ™Έκ°€ λ°μƒν•λ“  μ΄ ν΄λμ¤κ°€ μμ™Έλ¥Ό κ°€λ΅μ±„ μ²λ¦¬ν•©λ‹λ‹¤.
*   **μ¥μ **:
    *   **μμ™Έ μ²λ¦¬ λ΅μ§μ μ¤‘μ•™ν™”**: μμ™Έ μ²λ¦¬ μ½”λ“κ°€ λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό μ™„μ „ν λ¶„λ¦¬λμ–΄ μ½”λ“μ κ°€λ…μ„±κ³Ό μ μ§€λ³΄μμ„±μ΄ ν–¥μƒλ©λ‹λ‹¤.
    *   **μΌκ΄€λ μ—λ¬ μ‘λ‹µ**: λ¨λ“  APIκ°€ λ™μΌν• ν•μ‹μ μ—λ¬ λ©”μ‹μ§€λ¥Ό λ°ν™ν•λ„λ΅ ν‘μ¤€ν™”ν•  μ μμµλ‹λ‹¤.

    ```java
    @RestControllerAdvice
    public class GlobalExceptionHandler {

        // BusinessExceptionμ΄λΌλ” μ»¤μ¤ν…€ μμ™Έλ¥Ό μ „μ—­μ μΌλ΅ μ²λ¦¬
        @ExceptionHandler(BusinessException.class)
        public ResponseEntity<ErrorResponse> handleBusinessException(BusinessException ex) {
            ErrorCode errorCode = ex.getErrorCode();
            ErrorResponse response = new ErrorResponse(errorCode);
            return new ResponseEntity<>(response, errorCode.getHttpStatus());
        }

        // λ¨λ“  μΆ…λ¥μ Exceptionμ„ μ²λ¦¬ (κ°€μ¥ λ§μ§€λ§‰μ— μ„μΉ)
        @ExceptionHandler(Exception.class)
        public ResponseEntity<ErrorResponse> handleException(Exception ex) {
            // ...
        }
    }
    ```

---

### β… 2. λ°μ΄ν„° κ²€μ¦ (Validation)

*   ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° λ°›μ€ λ°μ΄ν„°(e.g., Request DTO)κ°€ λΉ„μ¦λ‹μ¤ κ·μΉ™μ— λ§λ”μ§€(e.g., nullμ΄ μ•„λ‹μ§€, μ΄λ©”μΌ ν•μ‹μΈμ§€) κ²€μ¦ν•λ” κ²ƒμ€ λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ μ§€ν‚¤κΈ° μ„ν• ν•„μμ μΈ κ³Όμ •μ…λ‹λ‹¤.

#### β• `spring-boot-starter-validation`

*   Spring Bootλ” `Jakarta Bean Validation` (κ³Όκ±° `Java EE Validation`) ν‘μ¤€μ„ μ‰½κ² μ‚¬μ©ν•  μ μλ„λ΅ μ΄ μ¤νƒ€ν„° μμ΅΄μ„±μ„ μ κ³µν•©λ‹λ‹¤.
*   DTOμ ν•„λ“μ— **`@NotNull`, `@NotEmpty`, `@Email`, `@Size`** λ“±κ³Ό κ°™μ€ μ–΄λ…Έν…μ΄μ…μ„ λ¶™μ—¬ κ²€μ¦ κ·μΉ™μ„ μ„ μ–Έμ μΌλ΅ μ •μν•  μ μμµλ‹λ‹¤.

#### β• `@Valid` μ–΄λ…Έν…μ΄μ…

*   μ»¨νΈλ΅¤λ¬μ λ©”μ„λ“ νλΌλ―Έν„°(μ£Όλ΅ `@RequestBody`κ°€ λ¶™μ€ DTO) μ•μ— `@Valid` μ–΄λ…Έν…μ΄μ…μ„ λ¶™μ΄λ©΄, Springμ΄ ν•΄λ‹Ή DTOμ— μ •μλ κ²€μ¦ κ·μΉ™μ„ **μλ™μΌλ΅ κ²€μ‚¬**ν•©λ‹λ‹¤.
*   λ§μ•½ κ²€μ¦μ— μ‹¤ν¨ν•λ©΄, `MethodArgumentNotValidException`μ΄λΌλ” μμ™Έκ°€ λ°μƒν•©λ‹λ‹¤.

*   **κ²€μ¦ μμ™Έ μ²λ¦¬**: μ„μ—μ„ μ„¤λ…ν• `@RestControllerAdvice`λ¥Ό μ‚¬μ©ν•μ—¬, `MethodArgumentNotValidException`μ„ μ΅μ•„λ‚΄κ³ , μ–΄λ–¤ ν•„λ“κ°€ μ–΄λ–¤ κ·μΉ™μ„ μ„λ°ν–λ”μ§€μ— λ€ν• μƒμ„Έν• μ •λ³΄λ¥Ό λ‹΄μ•„ μ‚¬μ©μ μΉν™”μ μΈ μ—λ¬ λ©”μ‹μ§€λ¥Ό μƒμ„±ν•μ—¬ μ‘λ‹µν•  μ μμµλ‹λ‹¤.

    ```java
    // Request DTO
    public class SignUpRequest {
        @NotEmpty(message = "μ΄λ©”μΌμ€ ν•„μμ…λ‹λ‹¤.")
        @Email(message = "μ΄λ©”μΌ ν•μ‹μ΄ μ¬λ°”λ¥΄μ§€ μ•μµλ‹λ‹¤.")
        private String email;

        @Size(min = 8, message = "λΉ„λ°€λ²νΈλ” 8μ μ΄μƒμ΄μ–΄μ•Ό ν•©λ‹λ‹¤.")
        private String password;
    }

    // Controller
    @RestController
    public class AuthController {
        @PostMapping("/signup")
        public ResponseEntity<Void> signUp(@Valid @RequestBody SignUpRequest request) {
            // κ²€μ¦μ„ ν†µκ³Όν• κ²½μ°μ—λ§ μ΄ λ΅μ§μ΄ μ‹¤ν–‰λ¨
            authService.signUp(request);
            return ResponseEntity.status(HttpStatus.CREATED).build();
        }
    }
    ```

---

### β… 3. λΉ„λ™κΈ° μ²λ¦¬ (`@Async`)

*   **λ¬Έμ μ **: μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ μ΄λ©”μΌ λ°μ†΅, νμΌ μ—…λ΅λ“, μ™Έλ¶€ API νΈμ¶ λ“± **μ‹κ°„μ΄ μ¤λ κ±Έλ¦¬λ” μ‘μ—…**μ„ λ™κΈ°(Synchronous) λ°©μ‹μΌλ΅ μ²λ¦¬ν•λ©΄, ν•΄λ‹Ή μ‘μ—…μ΄ λλ‚  λ•κΉμ§€ μ¤λ λ“κ°€ μ°¨λ‹¨(Blocking)λμ–΄ μ „μ²΄μ μΈ μ‹μ¤ν…μ μ‘λ‹µμ„±κ³Ό μ²λ¦¬λ‰μ΄ μ €ν•λ©λ‹λ‹¤.

*   **ν•΄κ²°μ±… (λΉ„λ™κΈ° μ²λ¦¬)**: μ‹κ°„μ΄ μ¤λ κ±Έλ¦¬λ” μ‘μ—…μ„ **λ³„λ„μ μ¤λ λ“**μ—μ„ μ‹¤ν–‰ν•λ„λ΅ μ„μ„ν•κ³ , μ›λμ μ¤λ λ“λ” μ¦‰μ‹ λ‹¤μ μ‘μ—…μ„ κ³„μ†ν•κ±°λ‚ μ‚¬μ©μμ—κ² μ‘λ‹µμ„ λ°ν™ν•λ” λ°©μ‹μ…λ‹λ‹¤.

#### β• Springμ `@Async` μ–΄λ…Έν…μ΄μ…

*   Springμ€ `@Async` μ–΄λ…Έν…μ΄μ…μ„ ν†µν•΄ λΉ„λ™κΈ° μ²λ¦¬λ¥Ό λ§¤μ° κ°„λ‹¨ν•κ² κµ¬ν„ν•  μ μλ„λ΅ μ§€μ›ν•©λ‹λ‹¤.

*   **μ‚¬μ©λ²•**:
    1.  **`@EnableAsync`**: λ©”μΈ μ• ν”λ¦¬μΌ€μ΄μ… ν΄λμ¤μ— `@EnableAsync` μ–΄λ…Έν…μ΄μ…μ„ λ¶™μ—¬ λΉ„λ™κΈ° κΈ°λ¥μ„ ν™μ„±ν™”ν•©λ‹λ‹¤.
    2.  **`@Async`**: λ³„λ„μ μ¤λ λ“μ—μ„ μ‹¤ν–‰ν•κ³  μ‹¶μ€ **`public` λ©”μ„λ“**μ— `@Async` μ–΄λ…Έν…μ΄μ…μ„ λ¶™μ…λ‹λ‹¤. μ΄ λ©”μ„λ“λ” λ°λ“μ‹ λ‹¤λ¥Έ ν΄λμ¤(Bean)μ—μ„ νΈμ¶λμ–΄μ•Ό ν•©λ‹λ‹¤. (AOP ν”„λ΅μ‹ λ°©μ‹)
    3.  **λ°ν™ νƒ€μ…**:
        *   λ°ν™ κ°’μ΄ μ—†λ” κ²½μ°: `void`
        *   λ°ν™ κ°’μ΄ ν•„μ”ν• κ²½μ°: `Future<T>` λλ” `CompletableFuture<T>`

    ```java
    @Service
    public class NotificationService {

        @Async // μ΄ λ©”μ„λ“λ” λ³„λ„μ μ¤λ λ“μ—μ„ λΉ„λ™κΈ°μ μΌλ΅ μ‹¤ν–‰λ¨
        public void sendEmail(String to, String subject, String body) {
            // μ‹κ°„μ΄ μ¤λ κ±Έλ¦¬λ” μ΄λ©”μΌ λ°μ†΅ λ΅μ§
            System.out.println("Sending email to: " + to);
            // ...
            System.out.println("Email sent!");
        }
    }

    // Controllerμ—μ„ νΈμ¶
    @RestController
    public class OrderController {
        // ...
        @PostMapping("/orders")
        public ResponseEntity<String> createOrder() {
            // ... μ£Όλ¬Έ μƒμ„± λ΅μ§ ...

            // μ΄λ©”μΌ λ°μ†΅μ€ λΉ„λ™κΈ°λ΅ μ„μ„ν•κ³ , μ¦‰μ‹ μ‚¬μ©μμ—κ² μ‘λ‹µ
            notificationService.sendEmail("user@example.com", "μ£Όλ¬Έ μ™„λ£", "...");

            return ResponseEntity.ok("μ£Όλ¬Έμ΄ μ„±κ³µμ μΌλ΅ μƒμ„±λμ—μµλ‹λ‹¤.");
        }
    }
    ```

---

### π“ μ”μ•½

*   **`@RestControllerAdvice`**μ™€ **`@ExceptionHandler`**λ¥Ό μ‚¬μ©ν•λ©΄, μ• ν”λ¦¬μΌ€μ΄μ… μ „μ—­μ—μ„ λ°μƒν•λ” **μμ™Έλ¥Ό μ¤‘μ•™μ—μ„ μΌκ΄€λκ² μ²λ¦¬**ν•  μ μμµλ‹λ‹¤.
*   **`spring-boot-starter-validation`**κ³Ό **`@Valid`** μ–΄λ…Έν…μ΄μ…μ„ ν†µν•΄, DTOμ— μ„ μ–Έλ **κ²€μ¦ κ·μΉ™μ„ μλ™μΌλ΅ κ²€μ‚¬**ν•μ—¬ λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ λ³΄μ¥ν•  μ μμµλ‹λ‹¤.
*   μ‹κ°„μ΄ μ¤λ κ±Έλ¦¬λ” μ‘μ—…(μ΄λ©”μΌ λ°μ†΅ λ“±)μ€ **`@Async`** μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•μ—¬ **λΉ„λ™κΈ°μ μΌλ΅ μ²λ¦¬**ν•¨μΌλ΅μ¨, μ‹μ¤ν…μ μ „μ²΄μ μΈ **μ‘λ‹µμ„±κ³Ό μ²λ¦¬λ‰**μ„ ν–¥μƒμ‹ν‚¬ μ μμµλ‹λ‹¤.