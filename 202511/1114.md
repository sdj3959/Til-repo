## 1113 Spring Boot μ‹¬ν™”: Filter, Interceptor, Argument Resolver

---

### β… 1. κ°μ”: μ”μ²­ μ²λ¦¬ κ³Όμ •μ—μ„μ λ¶€κ°€ κΈ°λ¥ μ¶”κ°€

*   Spring μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ΄ μ»¨νΈλ΅¤λ¬(Controller)μ ν•Έλ“¤λ¬ λ©”μ„λ“μ— λ„λ‹¬ν•κΈ°κΉμ§€λ” μ—¬λ¬ λ‹¨κ³„λ¥Ό κ±°μΉ©λ‹λ‹¤. **ν•„ν„°(Filter)**, **μΈν„°μ…‰ν„°(Interceptor)**, **Argument Resolver**λ” μ΄ κ³Όμ •μ κ°κΈ° λ‹¤λ¥Έ μ§€μ μ—μ„ **κ³µν†µμ μΈ λ¶€κ°€ κΈ°λ¥**μ„ μ¶”κ°€ν•κΈ° μ„ν•΄ μ‚¬μ©λλ” κ°•λ ¥ν• λ„κµ¬λ“¤μ…λ‹λ‹¤.

*   **μ‹¤ν–‰ μμ„**: `HTTP μ”μ²­` β†’ `Filter` β†’ `DispatcherServlet` β†’ `Interceptor` β†’ `Argument Resolver` β†’ `Controller`

---

### β… 2. ν•„ν„° (Filter)

*   **κ°λ…**: **μ„λΈ”λ¦Ώ(Servlet) μ»¨ν…μ΄λ„** μμ¤€μ—μ„ λ™μ‘ν•λ©°, `DispatcherServlet`μ— μ”μ²­μ΄ λ„λ‹¬ν•κΈ° **μ „/ν›„**μ— λ‹¤μ–‘ν• μ „μ²λ¦¬ λ° ν›„μ²λ¦¬ μ‘μ—…μ„ μν–‰ν•©λ‹λ‹¤. Spring ν”„λ μ„μ›ν¬μ λ°”κΉ¥, μ¦‰ **μ›Ή μ»¨ν…μ΄λ„(Tomcat λ“±)μ μμ—­**μ—μ„ λ™μ‘ν•©λ‹λ‹¤.

*   **μ£Όμ” μ—­ν• **:
    *   **μΈμ½”λ”© λ³€ν™**: λ¨λ“  μ”μ²­μ— λ€ν• λ¬Έμ μΈμ½”λ”©(e.g., UTF-8)μ„ μ„¤μ •ν•©λ‹λ‹¤.
    *   **λ³΄μ• λ° μΈμ¦**: Spring Securityλ” ν•„ν„° μ²΄μΈ(Filter Chain)μ„ κΈ°λ°μΌλ΅ λ™μ‘ν•μ—¬, μΈμ¦/μΈκ°€λμ§€ μ•μ€ μ”μ²­μ„ μ‚¬μ „μ— μ°¨λ‹¨ν•©λ‹λ‹¤.
    *   **λ΅κΉ… λ° κ°μ‚¬**: λ¨λ“  μ”μ²­/μ‘λ‹µμ— λ€ν• λ΅κ·Έλ¥Ό κΈ°λ΅ν•©λ‹λ‹¤.
    *   **CORS μ²λ¦¬**: Cross-Origin Resource Sharing ν—¤λ”λ¥Ό μ¶”κ°€ν•©λ‹λ‹¤.

*   **κµ¬ν„**: `jakarta.servlet.Filter` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•κ³ , `@Component` μ–΄λ…Έν…μ΄μ…μ„ λ¶™μ΄κ±°λ‚ `FilterRegistrationBean`μ„ ν†µν•΄ λ“±λ΅ν•©λ‹λ‹¤.

    ```java
    @Component
    public class MyLoggingFilter implements Filter {
        @Override
        public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
                throws IOException, ServletException {
            
            System.out.println("Filter: μ”μ²­ μ²λ¦¬ μ‹μ‘");
            // λ‹¤μ ν•„ν„° λλ” DispatcherServletμΌλ΅ μ”μ²­μ„ μ „λ‹¬
            chain.doFilter(request, response);
            System.out.println("Filter: μ‘λ‹µ μ²λ¦¬ μ™„λ£");
        }
    }
    ```

---

### β… 3. μΈν„°μ…‰ν„° (Interceptor)

*   **κ°λ…**: **Spring MVC** μμ¤€μ—μ„ λ™μ‘ν•λ©°, `DispatcherServlet`μ΄ μ»¨νΈλ΅¤λ¬λ¥Ό νΈμ¶ν•κΈ° **μ „/ν›„**μ— μ”μ²­μ„ κ°€λ΅μ±„λ” μ—­ν• μ„ ν•©λ‹λ‹¤. ν•„ν„°λ³΄λ‹¤ λ” μ •κµν• μ μ–΄κ°€ κ°€λ¥ν•©λ‹λ‹¤.

*   **μ£Όμ” μ—­ν• **:
    *   **μ„Έμ… λ° κ¶ν• μ²΄ν¬**: νΉμ • μ»¨νΈλ΅¤λ¬λ‚ λ©”μ„λ“μ— μ ‘κ·Όν•κΈ° μ „μ— μ‚¬μ©μμ λ΅κ·ΈμΈ μ—¬λ¶€λ‚ κ¶ν•μ„ ν™•μΈν•©λ‹λ‹¤.
    *   **λ΅κΉ…**: μ–΄λ–¤ μ»¨νΈλ΅¤λ¬μ μ–΄λ–¤ λ©”μ„λ“κ°€ νΈμ¶λμ—λ”μ§€, μ‹¤ν–‰ μ‹κ°„μ€ μ–Όλ§λ‚ κ±Έλ Έλ”μ§€ λ“±μ„ κΈ°λ΅ν•©λ‹λ‹¤.
    *   **`ModelAndView` μ΅°μ‘**: μ»¨νΈλ΅¤λ¬κ°€ μ²λ¦¬λ ν›„, λ·°(View)λ΅ μ „λ‹¬λλ” `Model` κ°μ²΄μ— κ³µν†µμ μΈ λ°μ΄ν„°λ¥Ό μ¶”κ°€ν•  μ μμµλ‹λ‹¤.

*   **κµ¬ν„**: `HandlerInterceptor` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•κ³ , `WebMvcConfigurer`λ¥Ό ν†µν•΄ μΈν„°μ…‰ν„°λ¥Ό λ“±λ΅ν•©λ‹λ‹¤.
    *   **`preHandle()`**: μ»¨νΈλ΅¤λ¬ μ‹¤ν–‰ **μ „**μ— νΈμ¶. `false`λ¥Ό λ°ν™ν•λ©΄ μ”μ²­ μ²λ¦¬λ¥Ό μ¤‘λ‹¨.
    *   **`postHandle()`**: μ»¨νΈλ΅¤λ¬ μ‹¤ν–‰ **ν›„**, λ·°κ°€ λ λ”λ§λκΈ° **μ „**μ— νΈμ¶.
    *   **`afterCompletion()`**: λ·° λ λ”λ§κΉμ§€ **λ¨λ‘ μ™„λ£λ ν›„**μ— νΈμ¶.

    ```java
    public class AuthInterceptor implements HandlerInterceptor {
        @Override
        public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
            // μ„Έμ… μ²΄ν¬ λ΅μ§
            if (session == null) {
                // λ΅κ·ΈμΈ νμ΄μ§€λ΅ λ¦¬λ‹¤μ΄λ ‰νΈ
                return false; // μ»¨νΈλ΅¤λ¬ μ‹¤ν–‰ μ¤‘λ‹¨
            }
            return true; // μ»¨νΈλ΅¤λ¬ μ‹¤ν–‰ κ³„μ†
        }
    }
    ```

---

### β… 4. Argument Resolver

*   **κ°λ…**: μ»¨νΈλ΅¤λ¬ λ©”μ„λ“μ **νΉμ • νλΌλ―Έν„°(Argument)**λ¥Ό μƒμ„±ν•κ³  λ°”μΈλ”©ν•λ” μ—­ν• μ„ μ „λ‹΄ν•λ” μ»΄ν¬λ„νΈμ…λ‹λ‹¤.
*   **λ¬Έμ μ **: μ—¬λ¬ μ»¨νΈλ΅¤λ¬ λ©”μ„λ“μ—μ„ κ³µν†µμ μΌλ΅ μ‚¬μ©μμ μ„Έμ… μ •λ³΄λ‚ νΉμ • ν—¤λ” κ°’μ„ νλΌλ―Έν„°λ΅ λ°›μ•„μ•Ό ν•  λ•, κ° λ©”μ„λ“λ§λ‹¤ `HttpServletRequest`λ¥Ό μ£Όμ…λ°›μ•„ μ •λ³΄λ¥Ό κΊΌλ‚΄λ” μ¤‘λ³µ μ½”λ“κ°€ λ°μƒν•©λ‹λ‹¤.
*   **ν•΄κ²°μ±…**: `HandlerMethodArgumentResolver`λ¥Ό κµ¬ν„ν•μ—¬, νΉμ • μ΅°κ±΄(e.g., νΉμ • μ–΄λ…Έν…μ΄μ…μ΄ λ¶™μ–΄μλ” νλΌλ―Έν„°)μ„ λ§μ΅±ν•λ” νλΌλ―Έν„°κ°€ μμ„ κ²½μ°, **Springμ΄ μ•μ•„μ„ μ›ν•λ” κ°μ²΄λ¥Ό μƒμ„±ν•μ—¬ μ£Όμ…**ν•΄μ£Όλ„λ΅ λ§λ“¤ μ μμµλ‹λ‹¤.

*   **Spring Securityμ `@AuthenticationPrincipal`**: μ΄ μ–΄λ…Έν…μ΄μ…μ΄ λ°”λ΅ Argument Resolverμ λ€ν‘μ μΈ ν™μ© μ‚¬λ΅€μ…λ‹λ‹¤. κ°λ°μλ” λ‹¨μν `@AuthenticationPrincipal UserDetails user`λΌκ³ λ§ μ„ μ–Έν•λ©΄, Spring Securityκ°€ μ κ³µν•λ” Argument Resolverκ°€ Security Contextμ—μ„ μ‚¬μ©μ μ •λ³΄λ¥Ό κΊΌλ‚΄ `user` νλΌλ―Έν„°μ— μ£Όμ…ν•΄μ¤λ‹λ‹¤.

#### β• μ»¤μ¤ν…€ Argument Resolver κµ¬ν„ νλ¦„

1.  `HandlerMethodArgumentResolver` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•©λ‹λ‹¤.
2.  **`supportsParameter()`**: μ–΄λ–¤ νλΌλ―Έν„°μ— μ΄ Resolverλ¥Ό μ μ©ν• μ§€ μ΅°κ±΄μ„ μ •μν•©λ‹λ‹¤.
3.  **`resolveArgument()`**: `supportsParameter()`κ°€ `true`λ¥Ό λ°ν™ν–μ„ λ•, μ‹¤μ λ΅ νλΌλ―Έν„°μ— μ£Όμ…ν•  κ°μ²΄λ¥Ό μƒμ„±ν•μ—¬ λ°ν™ν•λ” λ΅μ§μ„ μ‘μ„±ν•©λ‹λ‹¤.
4.  `WebMvcConfigurer`λ¥Ό ν†µν•΄ μ»¤μ¤ν…€ Argument Resolverλ¥Ό λ“±λ΅ν•©λ‹λ‹¤.

---

### β… 5. Filter vs Interceptor vs Argument Resolver

| κµ¬λ¶„ | Filter | Interceptor | Argument Resolver |
| :--- | :--- | :--- | :--- |
| **λ™μ‘ λ²”μ„** | **μ„λΈ”λ¦Ώ μ»¨ν…μ΄λ„** μμ¤€ | **Spring MVC** μμ¤€ | **μ»¨νΈλ΅¤λ¬ νλΌλ―Έν„°** μμ¤€ |
| **μ‹¤ν–‰ μ‹μ ** | DispatcherServlet **μ „/ν›„** | Controller **μ „/ν›„** | Controller νλΌλ―Έν„° λ°”μΈλ”© μ‹ |
| **μ£Όμ” μ©λ„** | β€Ά μ „μ—­μ μΈ μ”μ²­/μ‘λ‹µ μ²λ¦¬<br>β€Ά μΈμ½”λ”©, λ³΄μ• | β€Ά μ„Έλ¶€μ μΈ κ¶ν• μ²΄ν¬<br>β€Ά μ»¨νΈλ΅¤λ¬ λ΅κΉ… | β€Ά κ³µν†µ νλΌλ―Έν„° μ£Όμ…<br>β€Ά μ–΄λ…Έν…μ΄μ… κΈ°λ° κ°’ λ°”μΈλ”© |
| **μ ‘κ·Ό κ°€λ¥ μ •λ³΄** | `HttpServletRequest/Response` | `HttpServletRequest/Response`,<br>νΈμ¶λ  μ»¨νΈλ΅¤λ¬ μ •λ³΄(`Handler`) | `HttpServletRequest`,<br>λ°”μΈλ”©λ  νλΌλ―Έν„° μ •λ³΄ |

---

### π“ μ”μ•½

*   **Filter**λ” Springμ κ°€μ¥ λ°”κΉ¥μ—μ„ λ™μ‘ν•λ©°, λ¨λ“  μ”μ²­μ— λ€ν• **μ „μ—­μ μΈ μ „/ν›„μ²λ¦¬**λ¥Ό λ‹΄λ‹Ήν•©λ‹λ‹¤. (e.g., μΈμ½”λ”©, Spring Security)
*   **Interceptor**λ” Spring MVC λ‚΄λ¶€μ—μ„ λ™μ‘ν•λ©°, νΉμ • **μ»¨νΈλ΅¤λ¬μ μ‹¤ν–‰ μ „ν›„**μ— κ°μ…ν•μ—¬ κ¶ν• μ²΄ν¬λ‚ λ΅κΉ…κ³Ό κ°™μ€ λ¶€κ°€ κΈ°λ¥μ„ μν–‰ν•©λ‹λ‹¤.
*   **Argument Resolver**λ” μ»¨νΈλ΅¤λ¬ λ©”μ„λ“μ **νλΌλ―Έν„°λ¥Ό λ§λ“λ” κ³Όμ •**μ— κ°μ…ν•μ—¬, λ°λ³µμ μΈ νλΌλ―Έν„° μ¤€λΉ„ μ½”λ“λ¥Ό μ¤„μ΄κ³  κ³µν†µ λ΅μ§μ„ μΊ΅μν™”ν•©λ‹λ‹¤. (`@AuthenticationPrincipal`μ΄ λ€ν‘μ μΈ μ)
*   κ°κ°μ μ—­ν• κ³Ό λ™μ‘ λ²”μ„κ°€ λ‹¤λ¥΄λ―€λ΅, ν•΄κ²°ν•λ ¤λ” λ¬Έμ μ— κ°€μ¥ μ ν•©ν• λ„κµ¬λ¥Ό μ„ νƒν•μ—¬ μ‚¬μ©ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.