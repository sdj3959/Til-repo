## 1219 μ„λ²„ κ΄€λ¦¬ μ‹¬ν™”: κ°€μƒ νΈμ¤νΈμ™€ λ¦¬λ²„μ¤ ν”„λ΅μ‹ (Nginx)

---

### β… 1. κ°€μƒ νΈμ¤νΈ (Virtual Host)

*   **κ°€μƒ νΈμ¤νΈ**λ€ **ν•λ‚μ λ¬Όλ¦¬μ μΈ μ„λ²„(ν•λ‚μ IP μ£Όμ†)**μ—μ„ **μ—¬λ¬ κ°μ λ‹¤λ¥Έ λ„λ©”μΈ μ΄λ¦„**μ„ κ°€μ§„ μ›Ήμ‚¬μ΄νΈλ¥Ό μ΄μν•  μ μκ² ν•΄μ£Όλ” κΈ°μ μ…λ‹λ‹¤.
*   **μμ‹**: `example.com`κ³Ό `another-site.org`λΌλ” λ‘ κ°μ λ‹¤λ¥Έ μ›Ήμ‚¬μ΄νΈλ¥Ό μ„λ²„ ν• λ€λ΅ λ™μ‹μ— μ„λΉ„μ¤ν•λ” κ²ƒ.

*   **λ™μ‘ μ›λ¦¬**:
    1.  ν΄λΌμ΄μ–ΈνΈ(λΈλΌμ°μ €)κ°€ μ„λ²„μ— HTTP μ”μ²­μ„ λ³΄λ‚Ό λ•, μ”μ²­ ν—¤λ”(Header)μ—λ” μμ‹ μ΄ μ ‘μ†ν•λ ¤λ” **νΈμ¤νΈ(Host)μ λ„λ©”μΈ μ΄λ¦„**μ΄ ν¬ν•¨λ©λ‹λ‹¤. (e.g., `Host: example.com`)
    2.  μ›Ή μ„λ²„(Nginx)λ” μ΄ `Host` ν—¤λ” κ°’μ„ λ³΄κ³ , μ—¬λ¬ `server` λΈ”λ΅ μ„¤μ • μ¤‘μ—μ„ `server_name`μ΄ μΌμΉν•λ” μ„¤μ •μ„ μ°Ύμ•„ ν•΄λ‹Ή μ›Ήμ‚¬μ΄νΈμ μ½ν…μΈ λ¥Ό μ‘λ‹µν•©λ‹λ‹¤.

#### β• Nginxμ—μ„μ κ°€μƒ νΈμ¤νΈ μ„¤μ •

*   Nginxμ—μ„λ” `server` λΈ”λ΅ ν•λ‚κ°€ κ°€μƒ νΈμ¤νΈ ν•λ‚μ— ν•΄λ‹Ήν•©λ‹λ‹¤. `nginx.conf` νμΌμ— μ—¬λ¬ κ°μ `server` λΈ”λ΅μ„ μ‘μ„±ν•μ—¬ κ°€μƒ νΈμ¤νΈλ¥Ό κµ¬μ„±ν•  μ μμµλ‹λ‹¤.

*   **κ΄€λ¦¬μ μ©μ΄μ„±μ„ μ„ν• μ„¤μ • νμΌ λ¶„λ¦¬**:
    *   λ¨λ“  `server` λΈ”λ΅μ„ `nginx.conf`μ— λ‹¤ λ„£μΌλ©΄ νμΌμ΄ λ„λ¬΄ κΈΈκ³  λ³µμ΅ν•΄μ§‘λ‹λ‹¤.
    *   **λ¨λ²” μ‚¬λ΅€**: `/etc/nginx/conf.d/` λ””λ ‰ν† λ¦¬ μ•μ—, κ° μ‚¬μ΄νΈλ³„λ΅ λ³„λ„μ μ„¤μ • νμΌ(e.g., `example.com.conf`, `another-site.org.conf`)μ„ λ§λ“¤μ–΄ κ΄€λ¦¬ν•©λ‹λ‹¤. Nginxλ” μ‹μ‘ μ‹ μ΄ λ””λ ‰ν† λ¦¬ μ•μ `*.conf` νμΌλ“¤μ„ μλ™μΌλ΅ λ¨λ‘ μ½μ–΄λ“¤μ…λ‹λ‹¤.

    ```nginx
    # /etc/nginx/conf.d/example.com.conf

    server {
        listen 80;
        server_name example.com www.example.com;

        root /var/www/example.com/html;
        index index.html;

        location / {
            try_files $uri $uri/ =404;
        }
    }
    ```

    ```nginx
    # /etc/nginx/conf.d/another-site.org.conf

    server {
        listen 80;
        server_name another-site.org;

        root /var/www/another-site.org/html;
        index index.html;

        location / {
            try_files $uri $uri/ =404;
        }
    }
    ```

---

### β… 2. λ¦¬λ²„μ¤ ν”„λ΅μ‹ (Reverse Proxy)

*   **ν”„λ΅μ‹(Proxy)**λ” ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ μ‚¬μ΄μ—μ„ μ”μ²­κ³Ό μ‘λ‹µμ„ μ¤‘κ°ν•λ” μ„λ²„λ¥Ό μλ―Έν•©λ‹λ‹¤.
    *   **ν¬μ›λ“ ν”„λ΅μ‹ (Forward Proxy)**: **ν΄λΌμ΄μ–ΈνΈ μ½**μ— μ„μΉν•λ©°, ν΄λΌμ΄μ–ΈνΈλ¥Ό λ€μ‹ ν•μ—¬ μΈν„°λ„·μ— μ ‘μ†. (e.g., μ‚¬λ‚΄λ§μ—μ„ νΉμ • μ‚¬μ΄νΈ μ ‘κ·Ό, μΊμ‹±)
    *   **λ¦¬λ²„μ¤ ν”„λ΅μ‹ (Reverse Proxy)**: **μ„λ²„ μ½**μ— μ„μΉν•λ©°, ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ λ°›μ•„μ„ λ‚΄λ¶€ μ„λ²„(WAS)λ΅ μ „λ‹¬ν•κ³ , κ·Έ μ‘λ‹µμ„ λ‹¤μ‹ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „λ‹¬. ν΄λΌμ΄μ–ΈνΈλ” μμ‹ μ΄ μ‹¤μ  WASκ°€ μ•„λ‹ λ¦¬λ²„μ¤ ν”„λ΅μ‹μ™€ ν†µμ‹ ν•κ³  μμμ„ μ•μ§€ λ»ν•©λ‹λ‹¤.

#### β• λ¦¬λ²„μ¤ ν”„λ΅μ‹μ μ£Όμ” μ—­ν•  λ° μ¥μ 

1.  **λ΅λ“ λ°Έλ°μ‹± (Load Balancing)**:
    *   λ¦¬λ²„μ¤ ν”„λ΅μ‹κ°€ μ—¬λ¬ λ€μ λ‚΄λ¶€ WASλ΅ μ”μ²­μ„ λ¶„μ‚°μ‹μΌ, λ‹¨μΌ μ„λ²„μ κ³Όλ¶€ν•λ¥Ό λ°©μ§€ν•κ³  κ°€μ©μ„±μ„ λ†’μ…λ‹λ‹¤.

2.  **λ³΄μ• (Security)**:
    *   μ‹¤μ  WASμ IP μ£Όμ†λ‚ ν¬νΈμ™€ κ°™μ€ λ‚΄λ¶€ κµ¬μ΅°λ¥Ό μ™Έλ¶€μ— μ¨κΈΈ μ μμµλ‹λ‹¤.
    *   λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ„λ²„μ—μ„λ§ λ³΄μ• μ„¤μ •μ„ κ°•ν™”(SSL, λ°©ν™”λ²½ λ“±)ν•μ—¬, λ‚΄λ¶€ μ„λ²„λ“¤μ„ λ³΄νΈν•  μ μμµλ‹λ‹¤.

3.  **SSL μ•”νΈν™” μ²λ¦¬ (SSL Offloading)**:
    *   HTTPS ν†µμ‹ μ— ν•„μ”ν• λ³µμ΅ν• μ•”νΈν™”/λ³µνΈν™” μ‘μ—…μ„ λ¦¬λ²„μ¤ ν”„λ΅μ‹(Nginx)κ°€ μ „λ‹΄ν•κ³ , λ‚΄λ¶€ WASμ™€λ” κ°€λ²Όμ΄ HTTPλ΅ ν†µμ‹ ν•©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ WASλ” λΉ„μ¦λ‹μ¤ λ΅μ§ μ²λ¦¬μ—λ§ μ§‘μ¤‘ν•  μ μμµλ‹λ‹¤.

4.  **μΊμ‹± (Caching)**:
    *   μμ£Ό μ”μ²­λλ” μ •μ  μ½ν…μΈ λ¥Ό λ¦¬λ²„μ¤ ν”„λ΅μ‹κ°€ μΊμ‹±ν•΄λ‘μ—λ‹¤κ°€, WASκΉμ§€ μ”μ²­μ„ μ „λ‹¬ν•μ§€ μ•κ³  μ¦‰μ‹ μ‘λ‹µν•μ—¬ μ„±λ¥μ„ ν–¥μƒμ‹ν‚µλ‹λ‹¤.

#### β• Nginxλ¥Ό μ΄μ©ν• λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ„¤μ •

*   `location` λΈ”λ΅ λ‚΄μ—μ„ `proxy_pass` μ§€μ‹μ–΄λ¥Ό μ‚¬μ©ν•μ—¬ μ”μ²­μ„ μ „λ‹¬ν•  λ‚΄λ¶€ μ„λ²„μ μ£Όμ†λ¥Ό μ§€μ •ν•©λ‹λ‹¤.

    ```nginx
    # /etc/nginx/conf.d/my-app.conf

    server {
        listen 80;
        server_name my-app.com;

        # '/' κ²½λ΅λ΅ λ“¤μ–΄μ¤λ” λ¨λ“  μ”μ²­μ„ μ²λ¦¬
        location / {
            # μ”μ²­μ„ http://127.0.0.1:8080 (λ΅μ»¬μ—μ„ μ‹¤ν–‰ μ¤‘μΈ Spring Boot WAS)λ΅ μ „λ‹¬
            proxy_pass http://127.0.0.1:8080;

            # ν΄λΌμ΄μ–ΈνΈμ μ‹¤μ  IP, ν”„λ΅ν† μ½ λ“±μ μ •λ³΄λ¥Ό WASμ— μ „λ‹¬ν•κΈ° μ„ν• ν—¤λ” μ„¤μ •
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }
    }
    ```
*   **`proxy_set_header`**: WASκ°€ λ¦¬λ²„μ¤ ν”„λ΅μ‹ λ’¤μ— μλ‹¤λ” μ‚¬μ‹¤μ„ μΈμ§€ν•κ³ , ν΄λΌμ΄μ–ΈνΈμ μ‹¤μ  IP μ£Όμ† λ“±μ„ μ¬λ°”λ¥΄κ² λ΅κΉ…ν•κ±°λ‚ μ²λ¦¬ν•  μ μλ„λ΅ κ΄€λ ¨ μ •λ³΄λ¥Ό HTTP ν—¤λ”μ— λ‹΄μ•„ μ „λ‹¬ν•λ” μ¤‘μ”ν• μ„¤μ •μ…λ‹λ‹¤.

---

### π“ μ”μ•½

*   **κ°€μƒ νΈμ¤νΈ**λ” `server_name` μ§€μ‹μ–΄λ¥Ό μ‚¬μ©ν•μ—¬, **ν•λ‚μ μ„λ²„**μ—μ„ **μ—¬λ¬ λ„λ©”μΈμ μ›Ήμ‚¬μ΄νΈ**λ¥Ό μ΄μν•  μ μκ² ν•΄μ£Όλ” κΈ°μ μ…λ‹λ‹¤.
*   **λ¦¬λ²„μ¤ ν”„λ΅μ‹**λ” ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ λ°›μ•„ **λ‚΄λ¶€ WASλ΅ μ•μ „ν•κ² μ „λ‹¬**ν•λ” μ¤‘κ° μ„λ²„ μ—­ν• μ„ ν•©λ‹λ‹¤.
*   **Nginx**λ” λ›°μ–΄λ‚ μ„±λ¥ λ•λ¶„μ— **λ¦¬λ²„μ¤ ν”„λ΅μ‹** μ„λ²„λ΅ λ§¤μ° λ„λ¦¬ μ‚¬μ©λλ©°, `proxy_pass` μ§€μ‹μ–΄λ¥Ό ν†µν•΄ κ°„λ‹¨ν•κ² μ„¤μ •ν•  μ μμµλ‹λ‹¤.
*   λ¦¬λ²„μ¤ ν”„λ΅μ‹λ¥Ό μ‚¬μ©ν•λ©΄ **λ΅λ“ λ°Έλ°μ‹±, λ³΄μ• κ°•ν™”, SSL μ²λ¦¬, μΊμ‹±** λ“± λ‹¤μ–‘ν• μ΄μ μ„ μ–»μ„ μ μμ–΄, ν„λ€μ μΈ μ›Ή μ•„ν‚¤ν…μ²μ ν•„μμ μΈ κµ¬μ„± μ”μ†μ…λ‹λ‹¤.